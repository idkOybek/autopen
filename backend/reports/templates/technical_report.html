{% extends "report_base.html" %}

{% block title %}Technical Report - {{ scan_info.name }}{% endblock %}

{% block content %}
<div class="container">
    <header>
        <h1>Security Assessment Report</h1>
        <div class="subtitle">{{ scan_info.name }}</div>
    </header>
    
    <div class="metadata">
        <div class="metadata-item">
            <strong>Scan ID</strong>
            <span>{{ scan_info.id }}</span>
        </div>
        <div class="metadata-item">
            <strong>Date</strong>
            <span>{{ scan_info.date }}</span>
        </div>
        <div class="metadata-item">
            <strong>Duration</strong>
            <span>{{ scan_info.duration }} min</span>
        </div>
        <div class="metadata-item">
            <strong>Total Targets</strong>
            <span>{{ scan_info.total_targets }}</span>
        </div>
        <div class="metadata-item">
            <strong>Total Findings</strong>
            <span>{{ scan_info.total_findings }}</span>
        </div>
        <div class="metadata-item">
            <strong>Risk Score</strong>
            <span>{{ scan_info.risk_score }}/10</span>
        </div>
    </div>
    
    <div class="section">
        <h2 class="section-header">Executive Summary</h2>
        <p>
            This report presents the results of a comprehensive security assessment 
            conducted on {{ summary.total_targets }} target(s). 
            The assessment identified {{ summary.total_findings }} security finding(s), 
            including {{ summary.critical_count }} critical vulnerability/vulnerabilities 
            that require immediate attention.
        </p>
        
        <div class="stats-grid">
            <div class="stat-card" style="background-color: #fee;">
                <h3>{{ summary.critical_count }}</h3>
                <p>Critical</p>
            </div>
            <div class="stat-card" style="background-color: #fed;">
                <h3>{{ summary.high_count }}</h3>
                <p>High</p>
            </div>
            <div class="stat-card" style="background-color: #ffd;">
                <h3>{{ summary.medium_count }}</h3>
                <p>Medium</p>
            </div>
            <div class="stat-card" style="background-color: #ffe;">
                <h3>{{ summary.low_count }}</h3>
                <p>Low</p>
            </div>
            <div class="stat-card" style="background-color: #def;">
                <h3>{{ summary.info_count }}</h3>
                <p>Info</p>
            </div>
        </div>
    </div>
    
    <div class="section">
        <h2 class="section-header">Detailed Findings</h2>
        
        {% for finding in findings %}
        <div class="finding-card">
            <div class="finding-header">
                <div class="finding-title">{{ loop.index }}. {{ finding.title }}</div>
                <span class="severity-badge severity-{{ finding.severity }}">{{ finding.severity }}</span>
            </div>
            
            <div class="finding-meta">
                <div><strong>Type:</strong> {{ finding.finding_type }}</div>
                <div><strong>Confidence:</strong> {{ (finding.confidence * 100)|int }}%</div>
                {% if finding.cve_id %}
                <div><strong>CVE:</strong> {{ finding.cve_id }}</div>
                {% endif %}
                {% if finding.cvss_score %}
                <div><strong>CVSS:</strong> {{ finding.cvss_score }}</div>
                {% endif %}
            </div>
            
            <div class="finding-section">
                <h4>Description</h4>
                <p>{{ finding.description }}</p>
            </div>
            
            {% if finding.evidence %}
            <div class="finding-section">
                <h4>Evidence</h4>
                <div class="code-block">{{ finding.evidence }}</div>
            </div>
            {% endif %}
            
            {% if finding.remediation %}
            <div class="finding-section">
                <h4>Remediation</h4>
                <p>{{ finding.remediation }}</p>
            </div>
            {% endif %}
        </div>
        {% endfor %}
    </div>
</div>
{% endblock %}
